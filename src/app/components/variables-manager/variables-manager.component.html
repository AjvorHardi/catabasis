<div>
  <!-- Header -->
  <div class="flex justify-between items-center mb-6">
    <div>
      <h3 class="text-lg font-medium text-gray-900">Variables</h3>
      <p class="text-sm text-gray-600">Manage simple key-value pairs for your website</p>
    </div>
    <button
      *ngIf="!showCreateForm"
      (click)="showCreateVariableForm()"
      class="bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-2 px-4 rounded-md transition-colors">
      + Add Variable
    </button>
  </div>

  <!-- Error Message -->
  <div *ngIf="error" class="mb-6 p-4 bg-red-50 border border-red-200 rounded-md">
    <p class="text-sm text-red-600">{{ error }}</p>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading && variables.length === 0" class="text-center py-8">
    <div class="text-gray-500">Loading variables...</div>
  </div>

  <!-- Empty State -->
  <div *ngIf="!loading && variables.length === 0 && !showCreateForm" class="text-center py-12">
    <div class="text-4xl mb-4">⚙️</div>
    <h4 class="text-lg font-medium text-gray-900 mb-2">No variables yet</h4>
    <p class="text-gray-600 mb-6">Create your first variable to store simple values like counters, settings, or any text data</p>
    <button
      (click)="showCreateVariableForm()"
      class="bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-2 px-4 rounded-md transition-colors">
      Add Your First Variable
    </button>
  </div>

  <!-- Variables Grid -->
  <div *ngIf="variables.length > 0 || showCreateForm" class="h-22 bg-gray-50 border border-gray-200 rounded p-2 overflow-hidden">
    <div class="grid grid-cols-10 gap-x-2 h-full">
      <!-- Variable Boxes -->
      <div *ngFor="let variable of variables" class="h-full bg-white border border-gray-300 rounded p-2 hover:shadow-sm transition-shadow min-w-0 relative">
        <!-- View Mode -->
        <div *ngIf="editingVariable?.id !== variable.id" class="h-full flex flex-col justify-between relative">
          <!-- Three dots menu in top-right corner -->
          <div class="absolute top-0 right-0">
            <button
              (click)="toggleMenu(variable.id)"
              class="text-gray-400 hover:text-gray-600 p-1"
              title="Options">
              <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                <path d="M6 10a2 2 0 11-4 0 2 2 0 014 0zM12 10a2 2 0 11-4 0 2 2 0 014 0zM16 12a2 2 0 100-4 2 2 0 000 4z"></path>
              </svg>
            </button>
            
            <!-- Dropdown Menu -->
            <div *ngIf="showMenuForVariable === variable.id" 
                 class="absolute right-0 top-6 bg-white border border-gray-200 rounded shadow-lg z-50 min-w-[80px]">
              <button
                (click)="startEditVariable(variable)"
                class="block w-full text-left px-3 py-1 text-xs text-gray-700 hover:bg-gray-100">
                Edit
              </button>
              <button
                (click)="deleteVariable(variable)"
                class="block w-full text-left px-3 py-1 text-xs text-red-600 hover:bg-gray-100">
                Delete
              </button>
            </div>
          </div>
          
          <div class="text-xs font-medium text-gray-900 truncate mb-1 pr-4 overflow-hidden" [title]="variable.name">{{ variable.name }}</div>
          <div class="text-xs text-gray-700 font-mono bg-gray-50 px-1 py-1 rounded border text-center truncate overflow-hidden" [title]="variable.value">
            {{ variable.value }}
          </div>
        </div>

        <!-- Edit Mode -->
        <div *ngIf="editingVariable?.id === variable.id" class="h-full">
          <form [formGroup]="editForm" (ngSubmit)="saveVariable()" class="h-full flex flex-col justify-between">
            <input
              type="text"
              formControlName="name"
              class="w-full px-1 py-1 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 mb-1">
            <input
              type="text"
              formControlName="value"
              class="w-full px-1 py-1 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 mb-1">
            <div class="flex justify-center space-x-1">
              <button
                type="submit"
                [disabled]="!editForm.valid || loading"
                class="bg-indigo-600 hover:bg-indigo-700 disabled:bg-gray-400 text-white text-xs px-1 py-1 rounded transition-colors"
                title="Save">
                ✓
              </button>
              <button
                type="button"
                (click)="cancelEditVariable()"
                class="bg-gray-300 hover:bg-gray-400 text-gray-700 text-xs px-1 py-1 rounded transition-colors"
                title="Cancel">
                ✕
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Add Variable Box (if less than 10 variables and not editing) -->
      <div *ngIf="variables.length < 10 && !showCreateForm && !editingVariable" 
           class="h-full border-2 border-dashed border-gray-300 rounded p-2 flex items-center justify-center hover:border-indigo-400 transition-colors cursor-pointer overflow-hidden min-w-0"
           (click)="showCreateVariableForm()">
        <div class="text-center">
          <div class="text-2xl text-gray-400 mb-1">+</div>
          <div class="text-xs text-gray-500">Add Variable</div>
        </div>
      </div>

      <!-- Create Form Box -->
      <div *ngIf="showCreateForm" class="h-full bg-indigo-50 border-2 border-indigo-200 rounded p-2 overflow-hidden min-w-0">
        <form [formGroup]="createForm" (ngSubmit)="createVariable()" class="h-full flex flex-col justify-between">
          <input
            type="text"
            formControlName="name"
            class="w-full px-1 py-1 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 mb-1">
          <input
            type="text"
            formControlName="value"
            class="w-full px-1 py-1 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 mb-1">
          <div class="flex justify-center space-x-1">
            <button
              type="submit"
              [disabled]="!createForm.valid || loading"
              class="bg-indigo-600 hover:bg-indigo-700 disabled:bg-gray-400 text-white text-xs px-1 py-1 rounded transition-colors"
              title="Add">
              ✓
            </button>
            <button
              type="button"
              (click)="hideCreateVariableForm()"
              class="bg-gray-300 hover:bg-gray-400 text-gray-700 text-xs px-1 py-1 rounded transition-colors"
              title="Cancel">
              ✕
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>