<div>
  <!-- Header -->
  <div class="flex justify-between items-center mb-4">
    <div>
      <h4 class="text-lg font-medium text-gray-900">{{ database.name }} Data</h4>
      <p class="text-sm text-gray-600">{{ rows.length }} rows</p>
    </div>
    <button
      (click)="addNewRow()"
      [disabled]="loading"
      class="bg-indigo-600 hover:bg-indigo-700 disabled:bg-gray-400 text-white font-medium py-2 px-4 rounded-md transition-colors">
      + Add Row
    </button>
  </div>

  <!-- Error Message -->
  <div *ngIf="error" class="mb-4 p-3 bg-red-50 border border-red-200 rounded-md">
    <p class="text-sm text-red-600">{{ error }}</p>
    <button 
      (click)="error = ''"
      class="text-red-800 hover:text-red-900 text-xs underline mt-1">
      Dismiss
    </button>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading && rows.length === 0" class="text-center py-8">
    <div class="text-gray-500">Loading data...</div>
  </div>

  <!-- Empty State -->
  <div *ngIf="!loading && rows.length === 0" class="text-center py-12 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300">
    <div class="text-4xl mb-4">ðŸ“Š</div>
    <h4 class="text-lg font-medium text-gray-900 mb-2">No data yet</h4>
    <p class="text-gray-600 mb-6">Add your first row to start populating this database</p>
    <button
      (click)="addNewRow()"
      class="bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-2 px-4 rounded-md transition-colors">
      Add First Row
    </button>
  </div>

  <!-- Data Table -->
  <div *ngIf="rows.length > 0" class="bg-white border border-gray-200 rounded-lg overflow-hidden">
    <div class="overflow-x-auto">
      <table class="min-w-full divide-y divide-gray-200">
        <!-- Table Header -->
        <thead class="bg-gray-50">
          <tr>
            <th *ngFor="let column of database.columns" 
                class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
              {{ column }}
            </th>
            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20">
              Actions
            </th>
          </tr>
        </thead>
        
        <!-- Table Body -->
        <tbody class="bg-white divide-y divide-gray-200">
          <tr *ngFor="let row of rows; let i = index" 
              [class]="'hover:bg-gray-50 ' + (i % 2 === 0 ? 'bg-white' : 'bg-gray-25')">
            
            <!-- Data Cells -->
            <td *ngFor="let column of database.columns" 
                class="px-4 py-3 text-sm text-gray-900 relative">
              
              <!-- View Mode -->
              <div *ngIf="!isEditing(row.id, column)" 
                   class="cursor-pointer hover:bg-gray-100 rounded px-2 py-1 min-h-[24px] flex items-center"
                   (click)="startEditCell(row.id, column, getCellValue(row, column))"
                   [title]="'Click to edit ' + column">
                <span *ngIf="getCellValue(row, column)" class="truncate">{{ getCellValue(row, column) }}</span>
                <span *ngIf="!getCellValue(row, column)" class="text-gray-400 italic">Click to add {{ column }}</span>
              </div>

              <!-- Edit Mode -->
              <div *ngIf="isEditing(row.id, column)">
                <input
                  type="text"
                  [(ngModel)]="editValue"
                  (keydown)="onKeyDown($event)"
                  (blur)="saveCell()"
                  class="w-full px-2 py-1 text-sm border border-indigo-500 rounded focus:outline-none focus:ring-1 focus:ring-indigo-500"
                  #editInput>
              </div>
            </td>

            <!-- Actions Column -->
            <td class="px-4 py-3 text-sm font-medium">
              <button
                (click)="deleteRow(row)"
                class="text-red-600 hover:text-red-900 transition-colors"
                title="Delete row">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                </svg>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Table Footer -->
    <div class="bg-gray-50 px-4 py-3 border-t border-gray-200">
      <div class="flex justify-between items-center text-sm text-gray-600">
        <div>
          Total: {{ rows.length }} row{{ rows.length !== 1 ? 's' : '' }}
        </div>
        <div class="text-xs">
          Click any cell to edit â€¢ Press Enter to save â€¢ Press Escape to cancel
        </div>
      </div>
    </div>
  </div>
</div>